10 HGR2
20 C(0) = 0
30 C(1) = 4
40 D(0) = 0
50 D(1) = 3
60 FOR Y = 0 TO 191 STEP 24
70 CC = CC + 1
80 O1 = CC : O2 = 16 : GOSUB 2000 : CP = A
90 O1 = CP : O2 = 4 : GOSUB 2000 : P = A
100 GOSUB 1000 : D1 = C1 : D2 = C2
110 P = INT(CC/4)
120 GOSUB 1000
130 IF (D1=0 AND D2=0) OR (D1=0 AND C1=1) OR (D2=0 AND C2=1) THEN 70
140 FOR X = 6 TO 279-14 STEP 14
150 IF X=132 THEN X = X+21
160 HCOLOR = D(D1) : HPLOT X,Y TO X,Y+23
170 HCOLOR = D(D2) : HPLOT X+1,Y TO X+1,Y+23
180 HCOLOR = C(C1) : HPLOT X-1,Y TO X-1,Y+23
190 HCOLOR = C(C2) : HPLOT X+2,Y TO X+2,Y+23
200 NEXT X
210 NEXT Y
220 END
1000 O1 = P : O2 = 2: GOSUB 2000 : C1 = A
1010 C2 = INT(P/2)
1020 RETURN
2000 A = O1 - INT(O1/O2)*O2
2010 RETURN
RUN
